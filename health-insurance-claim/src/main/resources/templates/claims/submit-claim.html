<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title>Submit Claim</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" th:href="@{/assets/css/style.css}">
	<style>
		body {
			background: #f5f7fa;
			min-height: 100vh;
			display: flex;
			flex-direction: column;
			font-family: 'Poppins', sans-serif;
		}

		main {
			flex: 1;
		}

		.claim-form {
			max-width: 600px;
			margin: 3rem auto;
			background: #fff;
			border-radius: 12px;
			box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
			padding: 2rem 2.5rem;
		}

		.form-title {
			text-align: center;
			font-weight: 600;
			color: #2c3e50;
			margin-bottom: 1.5rem;
		}

		.btn-submit {
			width: 100%;
			background-color: #007bff;
			border: none;
		}

		.btn-submit:hover {
			background-color: #0056b3;
		}

		label {
			font-weight: 500;
		}
	</style>
</head>

<body>
	<!-- Navbar -->
	<div th:replace="~{fragments/navbar :: navbar}"></div>
	<main>
		<div class="container">
			<div class="claim-form">
				<h3 class="form-title">Submit Insurance Claim</h3>

				<form th:action="@{/claims/submit}" th:object="${claim}" method="post">

					<!-- ---------------- Agent Flow ---------------- -->
					<div th:if="${userRole} == 'AGENT'">
					 
					    <!-- Select Policy -->
					    <div class="mb-3">
					        <label for="policyId" class="form-label">Select Policy ID:</label>
					        <select id="policyId" th:field="*{policy.policyId}" class="form-select" required>
					            <option value="" disabled selected>Select a policy</option>
					            <option th:each="p : ${policies}"
					                    th:value="${p.policyId}"
					                    th:text="'Policy #' + ${p.policyId} + ' - ' + ${p.policyNumber}">
					            </option>
					        </select>
					    </div>
					 
					    <!-- Enter User ID (for whom agent is submitting claim) -->
					    <div class="mb-3">
					        <label for="userId" class="form-label">User ID:</label>
					        <input type="number"
					               id="userId"
					               th:field="*{user.userId}"
					               class="form-control"
					               placeholder="Enter User ID for the policyholder"
					               required>
					        <small class="text-muted">Enter the ID of the user enrolled under this policy.</small>
					    </div>
					 
					    <!-- Claim Amount -->
					    <div class="mb-3">
					        <label for="claimAmount" class="form-label">Claim Amount (â‚¹):</label>
					        <input type="number"
					               id="claimAmount"
					               th:field="*{claimAmount}"
					               class="form-control"
					               placeholder="Enter claim amount"
					               required min="1">
					    </div>
					 
					    <!-- Optional Description -->
					    <div class="mb-3">
					        <label for="description" class="form-label">Description (optional):</label>
					        <textarea id="description"
					                  
					                  class="form-control"
					                  placeholder="Describe the reason for claim..."
					                  rows="3"></textarea>
					    </div>
					 
					</div>
					<!-- ---------------- Policyholder Flow ---------------- -->
					<div th:if="${userRole} != 'AGENT'">
						<div class="mb-3">
							<label>Policy</label>
							<select th:field="*{policy.policyId}" class="form-select">
								<option th:each="p : ${policies}" th:value="${p.policyId}" th:text="${p.policyNumber}">
								</option>
							</select>
							<div th:if="${#fields.hasErrors('policy')}" th:errors="*{policy}" class="text-danger"></div>
						</div>

						<div class="mb-3">
							<label>Claim Amount</label>
							<input type="number" th:field="*{claimAmount}" class="form-control" />
							<div th:if="${#fields.hasErrors('claimAmount')}" th:errors="*{claimAmount}"
								class="text-danger"></div>
						</div>

						<div class="mb-3">
							<label>Description</label>
							<textarea class="form-control"></textarea>
							<div class="text-danger"></div>
						</div>
					</div>

					<!-- Submit Button -->
					<button type="submit" class="btn btn-submit btn-primary mt-3">Submit Claim</button>
				</form>

			</div>
		</div>
	</main>

	<!-- Footer -->
	<div th:replace="~{fragments/footer :: footer}"></div>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script th:src="@{/assets/js/script.js}"></script>
</body>

</html>